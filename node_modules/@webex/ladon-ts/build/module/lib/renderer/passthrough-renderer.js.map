{"version":3,"file":"passthrough-renderer.js","sources":["../../../../src/lib/renderer/passthrough-renderer.ts"],"sourcesContent":["import { PipelineConfig } from '../config-types';\nimport { FrameData } from '../generator';\nimport { compileShader, linkProgram } from '../util';\n\nimport { LadonRenderer } from './ladon-renderer';\nimport { WebGLRenderer } from './webgl-renderer';\n\nexport class PassthroughRenderer extends WebGLRenderer implements LadonRenderer {\n    private program: WebGLProgram;\n\n    private fragment_shader = `#version 300 es\nprecision highp float;\n\nout vec4 outColor;\n\nuniform sampler2D       u_image;\nuniform vec2            u_resolution;\n\n\nvoid main() {\n    ${this.getUVCalculation()}\n\n    outColor = vec4(texture(u_image, st).rgb, 1.0);\n}\n`;\n\n    constructor(public output_canvas: HTMLCanvasElement, public readonly config: PipelineConfig) {\n        super(output_canvas, config);\n\n        const vertex_shader = compileShader(this.gl, this.gl.VERTEX_SHADER, this.vertex_shader_src);\n        const fragment_shader = compileShader(\n            this.gl,\n            this.gl.FRAGMENT_SHADER,\n            this.fragment_shader\n        );\n\n        this.program = linkProgram(this.gl, vertex_shader, fragment_shader);\n        this.gl.useProgram(this.program);\n\n        this.setSharedUniforms(this.program);\n    }\n\n    public async render(input: FrameData): Promise<void> {\n        this.uploadVideoStream(input);\n\n        this.gl.useProgram(this.program);\n\n        this.gl.drawArrays(this.gl.TRIANGLES, 0, this.verts.length / 3);\n\n        this.postDraw();\n    }\n\n    public async load(): Promise<void> {\n        // empty\n    }\n\n    public destroy(): void {\n        // empty\n    }\n}\n"],"names":["PassthroughRenderer","WebGLRenderer","output_canvas","config","vertex_shader","compileShader","fragment_shader","linkProgram","input"],"mappings":";;AAOO,MAAMA,UAA4BC,EAAuC;AAAA,EAmB5E,YAAmBC,GAAkDC,GAAwB;AACzF,UAAMD,GAAeC,CAAM,GADZ,KAAA,gBAAAD,GAAkD,KAAA,SAAAC,GAhBrE,KAAQ,kBAAkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAUxB,KAAK,iBAAkB,CAAA;AAAA;AAAA;AAAA;AAAA;AASf,UAAAC,IAAgBC,EAAc,KAAK,IAAI,KAAK,GAAG,eAAe,KAAK,iBAAiB,GACpFC,IAAkBD;AAAA,MACpB,KAAK;AAAA,MACL,KAAK,GAAG;AAAA,MACR,KAAK;AAAA,IACT;AAEA,SAAK,UAAUE,EAAY,KAAK,IAAIH,GAAeE,CAAe,GAC7D,KAAA,GAAG,WAAW,KAAK,OAAO,GAE1B,KAAA,kBAAkB,KAAK,OAAO;AAAA,EAAA;AAAA,EAGvC,MAAa,OAAOE,GAAiC;AACjD,SAAK,kBAAkBA,CAAK,GAEvB,KAAA,GAAG,WAAW,KAAK,OAAO,GAE1B,KAAA,GAAG,WAAW,KAAK,GAAG,WAAW,GAAG,KAAK,MAAM,SAAS,CAAC,GAE9D,KAAK,SAAS;AAAA,EAAA;AAAA,EAGlB,MAAa,OAAsB;AAAA,EAAA;AAAA,EAI5B,UAAgB;AAAA,EAAA;AAG3B;"}